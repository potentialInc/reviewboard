{
  "version": "1.0",
  "description": "Architecture enforcement rules for agent-first development",
  "layers": {
    "order": [
      "types",
      "config",
      "repo",
      "service",
      "runtime",
      "ui"
    ],
    "direction": "top-down",
    "description": "Dependencies must flow downward. A layer can only import from layers above it."
  },
  "forbidden_imports": {
    "types": [
      "config",
      "repo",
      "service",
      "runtime",
      "ui"
    ],
    "config": [
      "repo",
      "service",
      "runtime",
      "ui"
    ],
    "repo": [
      "service",
      "runtime",
      "ui"
    ],
    "service": [
      "runtime",
      "ui"
    ],
    "runtime": [
      "ui"
    ]
  },
  "module_boundaries": {
    "enforce": true,
    "description": "Each top-level directory under src/ is a module. Cross-module imports must go through the module's public index.",
    "public_entry": "index.ts|index.js|index.py|__init__.py|mod.rs"
  },
  "naming_conventions": {
    "files": "kebab-case",
    "directories": "kebab-case",
    "classes": "PascalCase",
    "functions": "camelCase|snake_case",
    "constants": "UPPER_SNAKE_CASE",
    "types": "PascalCase"
  },
  "file_rules": {
    "max_lines": 300,
    "one_concern_per_file": true,
    "description": "Files exceeding 300 lines should be split. Each file handles one responsibility."
  },
  "test_rules": {
    "required_for": "public functions",
    "location": "colocated or __tests__/ directory",
    "naming": "*.test.ts|*.spec.ts|test_*.py|*_test.go"
  },
  "protected_paths": {
    "paths": [
      "harness/",
      "hooks/",
      "architecture/",
      ".claude/",
      "CLAUDE.md"
    ],
    "enforcement": "block",
    "message": "This file is part of the harness core. A human must add it to exceptions.allowed_core_edits."
  },
  "exceptions": {
    "description": "Files or patterns that are exempt from specific rules",
    "allowed_cross_layer": [],
    "allowed_large_files": [
      "harness/deploy-manager.sh",
      "harness/stack-detector.sh",
      "harness/db-manager.sh",
      "harness/project-init.sh",
      "harness/env-manager.sh",
      "harness/orchestrator.sh",
      "harness/worktree-manager.sh",
      "harness/prd-gate.sh",
      "architecture/enforce.sh",
      "hooks/skill-activation-prompt.sh",
      "harness/pipeline-runner.sh",
      "harness/prompt-builder.sh",
      "harness/phase-validator.sh",
      "harness/fullstack-runner.sh"
    ],
    "allowed_naming_exceptions": [],
    "allowed_core_edits": [
      "harness/prompt-builder.sh",
      "harness/pipeline-runner.sh",
      "harness/phase-validator.sh",
      "harness/fullstack-runner.sh",
      "harness/design-detector.sh",
      "skills/prd-normalize/normalize.sh",
      "skills/prd-normalize/run.md",
      "orchestration/PILOT_GUIDE.md"
    ]
  }
}
